{"version":3,"file":"abstract-element.js","sourceRoot":"","sources":["../src/abstract-element.ts"],"names":[],"mappings":"AAAA,OAAO,SAAS,MAAM,eAAe,CAAC;AAOtC,MAAM,sBAAgC,SAAQ,WAAW;IAyBvD,YACE,cAAsB,EAAE,EACxB,MAAM,GAAG,KAAK,EACd,OAA0B,MAAM;QAEhC,KAAK,EAAE,CAAC;QA5BF,cAAS,GAAY,KAAK,CAAC;QAEzB,SAAI,GAAG,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC5B,SAAI,GAAG,SAAS,CAAC,IAAI,CAAC;QACtB,SAAI,GAA4B,EAAE,CAAC;QAyB3C,IAAI;YACF,IAAI,CAAC,MAAM,GAAG,WAAW,CAAC;SAC3B;QAAC,OAAO,KAAK,EAAE;YACd,OAAO,CAAC,IAAI,CAAC,8BAA8B,CAAC,CAAC;SAC9C;QAED,IAAI,MAAM,EAAE;YACV,IAAI,CAAC,IAAI,GAAG,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC;SACzD;aAAM;YACL,IAAI,CAAC,IAAI,GAAG,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SAClC;QAED,IAAI,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,MAAM,KAAK,EAAE,EAAE;YACrC,IAAI,CAAC,MAAM,GAAG,SAAS,CAAC,IAAI,EAAE,CAAC,UAAU,IAAI,CAAC,MAAM,UAAU,CAAC;SAChE;IACH,CAAC;IApCD,IAAc,KAAK,CAAC,QAAa;QAC/B,IAAI,CAAC,MAAM,GAAG,QAAQ,IAAI,IAAI,CAAC,KAAK,CAAC;QACrC,IAAI,CAAC,UAAU,EAAE,CAAC;IACpB,CAAC;IACD,IAAc,KAAK;QACjB,OAAO,IAAI,CAAC,MAAM,CAAC;IACrB,CAAC;IAED,MAAM,KAAK,kBAAkB;QAC3B,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;QAE5B,OAAO,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC,CAAC;IACrE,CAAC;IAgCD,iBAAiB,CAAC,mBAA6B,EAAE;QAC/C,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;QACtB,IAAI,CAAC,UAAU,EAAE,CAAC;IACpB,CAAC;IAOD,wBAAwB,CAAC,IAAI,EAAE,QAAQ,EAAE,QAAQ;QAC/C,IAAI,QAAQ,KAAK,QAAQ,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,QAAQ,EAAE;YACzD,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,QAAQ,CAAC;YAC3B,IAAI,CAAC,UAAU,EAAE,CAAC;SACnB;IACH,CAAC;IAMD,UAAU;QACR,IAAI,IAAI,CAAC,SAAS,EAAE;YAClB,IAAI,CAAC,IAAI,CAAA,GAAG,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,EAAE,EAAE,CAAC;SAC3C;IACH,CAAC;;AA9EM,yBAAS,GAA4B,EAAE,CAAC;AAyFjD,MAAM,iBAAiB,OAAe;IACpC,OAAO,CAAC,mBAAyC,EAAE,EAAE;QACnD,IAAI;YACF,cAAc,CAAC,MAAM,CAAC,OAAO,EAAE,mBAAmB,CAAC,CAAC;SACrD;QAAC,OAAO,KAAK,EAAE;YACd,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAA;SACpB;IACH,CAAC,CAAC;AACJ,CAAC","sourcesContent":["import hyperHTML from 'hyperhtml/esm';\n\n\n\n/**\n * Abstract element to create web component with hyperHTML render function\n */\nexport abstract class AbstractElement extends HTMLElement {\n  static attrNames: { [x: string]: string } = {};\n  private connected: boolean = false;\n  private bind: any;\n  protected html = hyperHTML.wire(this);\n  protected wire = hyperHTML.wire;\n  protected attr: { [x: string]: string } = {};\n  protected _style: string;\n\n  private _scope: any;\n  protected set state(newState: any) {\n    this._scope = newState || this.state;\n    this.realRender();\n  }\n  protected get state() {\n    return this._scope;\n  }\n\n  static get observedAttributes() {\n    console.log(this.attrNames);\n    \n    return Object.keys(this.attrNames).map(key => this.attrNames[key]);\n  }\n\n\n  constructor(\n    staticStyle: string = '',\n    shadow = false,\n    mode: 'open' | 'closed' = 'open'\n  ) {\n    super();\n    try {\n      this._style = staticStyle;\n    } catch (error) {\n      console.warn('Can not find a static style!');\n    }\n\n    if (shadow) {\n      this.bind = hyperHTML.bind(this.attachShadow({ mode }));\n    } else {\n      this.bind = hyperHTML.bind(this);\n    }\n\n    if (this._style && this._style !== '') {\n      this._style = hyperHTML.wire() `<style>${this._style}</style>`;\n    }\n  }\n\n\n\n  /**\n   * LIFECYCLE\n   * Invoked when the custom element is first connected to the document's DOM.\n   */\n  connectedCallback(initialPropsList: string[] = []): void {\n    this.connected = true;\n    this.realRender();\n  }\n\n\n  /**\n   * LIFECYCLE\n   * Invoked when one of the custom element's attributes is added, removed, or changed.\n   */\n  attributeChangedCallback(name, oldValue, newValue) {\n    if (oldValue !== newValue && this.attr[name] !== newValue) {\n      this.attr[name] = newValue;\n      this.realRender();\n    }\n  }\n\n\n  /**\n   * Render function\n   */\n  realRender(): void {\n    if (this.connected) {\n      this.bind`${this._style}${this.render()}`;\n    }\n  }\n\n\n  abstract render(): () => void;\n\n}\n\n\n/**\n * Directive for define Custom Element\n */\nexport function Define(nameTag: string) {\n  return (originalConstructor: new (...args) => any) => {\n    try {\n      customElements.define(nameTag, originalConstructor);\n    } catch (error) {\n      console.warn(error)\n    }\n  };\n}\n"]}